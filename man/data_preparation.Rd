% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data_preparation.R
\name{data_preparation}
\alias{data_preparation}
\title{Run General Analysis on Several Experiments}
\arguments{
\item{data_patient}{A data frame containing patient data, with required columns:
\itemize{
\item \code{sample}: character
\item \code{chr}: character
\item \code{pos}: integer
\item \code{reference}: character
\item \code{alternative}: character
\item \code{zygosity}: integer
}}

\item{data_control}{A data frame containing control data, with the same required columns as \code{data_patient}.}

\item{mapqv_threshold}{Minimum mapping quality value for variants (default: 20).}

\item{min_coverage}{Minimum coverage threshold for filtering variants (default: 20).}

\item{remove_individual}{Logical. Whether to remove individuals not meeting coverage criteria (default: \code{TRUE}).}

\item{remove_position}{Logical. Whether to remove positions not meeting coverage criteria (default: \code{TRUE}).}

\item{path_to_store_plots}{A string specifying the directory to store generated plots and results (default: "").}

\item{coverage_matrix_path}{Path to the coverage matrix file, or 0 if no coverage matrix is provided (default: 0).}
}
\value{
A list containing processed data and results:
\itemize{
\item \code{data_patient_annotated}: Annotated patient data.
\item \code{data_control_annotated}: Annotated control data.
\item \code{clean_genotype_matrix}: Cleaned genotype matrix.
\item \code{missing_annotation}: Placeholder for missing annotations (currently \code{NA}).
\item \code{variant_target}: Filtered variant information.
\item \code{clean_coverage_matrix}: Cleaned coverage matrix (if applicable).
\item \code{rejected_variant}: Variants removed due to coverage thresholds.
\item \code{rejected_data_patient}: Rejected patient data due to coverage thresholds.
\item \code{rejected_data_control}: Rejected control data due to coverage thresholds.
}
}
\description{
Prepares data for analysis by annotating VCF files with VEP, creating a BED file, and building genotype and coverage matrices. The function includes steps for harmonizing coverage data and cleaning input data based on thresholds and user preferences.
}
