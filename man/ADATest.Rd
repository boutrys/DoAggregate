% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ADATest.R
\name{ADATest}
\alias{ADATest}
\title{Adaptive Combination of P-values (ADA) Test}
\usage{
ADATest(
  genotype,
  phenotype,
  mafThr = 0.05,
  num_perm = 1000,
  midp = FALSE,
  mode = "additive",
  twoSided = TRUE
)
}
\arguments{
\item{genotype}{A numeric matrix where rows represent samples and columns represent
variants. The entries should encode genotype information, with missing values indicated
as negative numbers.}

\item{phenotype}{A numeric vector representing the case-control status of samples.
Use \code{1} for cases and \code{0} for controls.}

\item{mafThr}{A numeric value specifying the minor allele frequency (MAF) threshold
for filtering variants. Defaults to \code{0.05}.}

\item{num_perm}{An integer specifying the number of permutations to perform for the
adaptive algorithm. Defaults to \code{1000}.}

\item{midp}{A logical value indicating whether to use the mid-p adjustment for the
hypergeometric test. Defaults to \code{FALSE}.}

\item{mode}{A character string specifying the genetic model. Options include
\code{'additive'}, \code{'dominant'}, and \code{'recessive'}. Defaults to \code{'additive'}.}

\item{twoSided}{A logical value indicating whether a two-sided test should be performed.
Defaults to \code{TRUE}.}
}
\value{
A list containing:
\item{pval}{The aggregated p-value from the ADA test.}
\item{optimal.t}{The optimal threshold for combining p-values.}
\item{posit}{Indices of the variants contributing to the signal.}
}
\description{
The \code{ADATest} function implements the Adaptive Combination of P-values (ADA) algorithm.
This method is designed for case-control sequence data to identify rare causal variants
from a large number of variants within a gene.

The algorithm adaptively combines p-values across variants, effectively pinpointing
associations that may not be detectable through traditional aggregation methods.
It is particularly suitable for rare-variant association studies in genetic research.
}
\examples{
# Simulated genotype and phenotype data
genotype <- matrix(rbinom(1000, 2, 0.1), nrow = 100, ncol = 10)
phenotype <- c(rep(1, 50), rep(0, 50))

# Run the ADA test
result <- ADATest(genotype, phenotype)

# View the results
print(result$pval)      # Aggregated p-value
print(result$optimal.t) # Optimal threshold
print(result$posit)     # Indices of significant variants

}
\references{
Lin W-Y (2016). Beyond rare-variant association testing: Pinpointing rare causal variants
in case-control sequencing study. Scientific Reports, 6: 21824.

Lin W-Y, Lou XY, Gao G, Liu N (2014). Rare Variant Association Testing by Adaptive
Combination of P-values. PLoS ONE, 9: e85728. \href{https://pubmed.ncbi.nlm.nih.gov/24454922}{PMID: 24454922}.

Cheung YH, Wang G, Leal SM, Wang S (2012). A fast and noise-resilient approach to detect
rare-variant associations with deep sequencing data for complex disorders. Genetic
Epidemiology, 36(7):675-685.
}
\seealso{
\code{getPvalADA}, \code{getScoreADA}, \code{getScoreADAoriginal}
}
